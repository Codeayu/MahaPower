{% extends "base.html" %}
{% load static %}

{% block title %}Work Suggestion Management Portal | Maharashtra State Khadi & Village Industries Board{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header Section -->
    <div class="text-center mb-10">
        <h2 class="text-3xl font-bold text-gray-800 mb-2 english-text">Work Suggestion Management Portal</h2>
        <h2 class="text-3xl font-bold text-gray-800 mb-2 marathi-text hidden">कामाच्या सूचना व्यवस्थापन पोर्टल</h2>
        <div class="w-20 h-1 bg-saffron mx-auto mb-4"></div>
        <p class="text-gray-600 max-w-2xl mx-auto english-text">Manage and review work suggestions for different locations and sectors.</p>
        <p class="text-gray-600 max-w-2xl mx-auto marathi-text hidden">विविध ठिकाणे आणि क्षेत्रांसाठी कामाच्या सूचना व्यवस्थापित आणि पुनरावलोकन करा.</p>
    </div>

    <!-- Action Buttons Section -->
    <div class="flex justify-between items-center mb-6">
        <div class="flex items-center space-x-2">
            <h3 class="text-xl font-semibold text-gray-700 english-text">Work Suggestions</h3>
            <h3 class="text-xl font-semibold text-gray-700 marathi-text hidden">कामाच्या सूचना</h3>
        </div>
        <a href="{% url 'create_suggestion' %}" class="px-4 py-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-0.5 flex items-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            <span class="english-text">Create Suggestion</span>
            <span class="marathi-text hidden">नवीन सूचना तयार करा</span>
        </a>
    </div>

    <!-- Form Section with improved UI -->
    <div class="rounded-xl shadow-lg overflow-hidden border border-gray-200 mb-10 transform transition-all duration-300 hover:shadow-xl">
        <div class="p-5 bg-gradient-to-r from-navyBlue to-blue-700 text-white">
            <div class="flex flex-wrap justify-between items-center">
                <h4 class="text-2xl font-semibold english-text mb-2 md:mb-0">Work Suggestions Form</h4>
                <h4 class="text-2xl font-semibold marathi-text hidden mb-2 md:mb-0">कामाच्या सूचना फॉर्म</h4>
                
                <!-- Language Toggle with improved styling -->
                <div class="flex bg-white rounded-full p-1 shadow-sm">
                    <button type="button" id="englishBtn" class="px-4 py-1.5 rounded-full bg-saffron text-white text-sm font-medium transition-all duration-200">English</button>
                    <button type="button" id="marathiBtn" class="px-4 py-1.5 rounded-full text-gray-700 text-sm font-medium transition-all duration-200">मराठी</button>
                </div>
            </div>
        </div>
        
        <div class="p-6 bg-white">
            <form method="get" class="grid grid-cols-1 md:grid-cols-2 gap-6" id="suggestionForm">
                <!-- District Dropdown with improved styling -->
                <div class="relative">
          <label for="district" class="block text-sm font-medium text-gray-600 mb-1.5 english-text">District</label>
          <label for="district" class="block text-sm font-medium text-gray-600 mb-1.5 marathi-text hidden">जिल्हा</label>
          <select id="district" name="district" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-saffron focus:border-transparent appearance-none bg-white">
            <option value="">{% if is_english %}Select District{% else %}जिल्हा निवडा{% endif %}</option>
            {% for district in districts %}
              <option value="{{ district.id }}" 
                data-name-en="{{ district.name_en }}" 
                data-name-mr="{{ district.name_mr }}"
                {% if district.id|stringformat:"s" == selected_district %}selected{% endif %}>
                {{ district.name_mr }}
              </option>
            {% endfor %}
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 pt-6">
            <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>
            </svg>
          </div>
        </div>

        <!-- Taluka Dropdown with improved styling -->
        <div class="relative">
          <label for="taluka" class="block text-sm font-medium text-gray-600 mb-1.5 english-text">Taluka</label>
          <label for="taluka" class="block text-sm font-medium text-gray-600 mb-1.5 marathi-text hidden">तालुका</label>
          <select id="taluka" name="taluka" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-saffron focus:border-transparent appearance-none bg-white">
            <option value="">Select Taluka</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 pt-6">
            <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>
            </svg>
          </div>
          <div id="taluka-loading" class="hidden absolute right-10 top-1/2 transform -translate-y-1/3">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-saffron"></div>
          </div>
        </div>

        <!-- Gram Panchayat Dropdown with improved styling -->
        <div class="relative">
          <label for="gram_panchayat" class="block text-sm font-medium text-gray-600 mb-1.5 english-text">Gram Panchayat</label>
          <label for="gram_panchayat" class="block text-sm font-medium text-gray-600 mb-1.5 marathi-text hidden">ग्रामपंचायत</label>
          <select id="gram_panchayat" name="gram_panchayat" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-saffron focus:border-transparent appearance-none bg-white">
            <option value="">Select Gram Panchayat</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 pt-6">
            <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>
            </svg>
          </div>
          <div id="gp-loading" class="hidden absolute right-10 top-1/2 transform -translate-y-1/3">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-saffron"></div>
          </div>
        </div>

        <!-- Sector Dropdown with improved styling -->
        <!-- Sector Dropdown with improved styling -->
<div class="relative">
  <label for="sector" class="block text-sm font-medium text-gray-600 mb-1.5 english-text">Sector</label>
  <label for="sector" class="block text-sm font-medium text-gray-600 mb-1.5 marathi-text hidden">क्षेत्र</label>
  <select id="sector" name="sector" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-saffron focus:border-transparent appearance-none bg-white required">
    <option value="">{% if is_english %}Select Sector{% else %}क्षेत्र निवडा{% endif %}</option>
    {% for sector in sectors %}
      <option value="{{ sector.id }}" 
        data-name-en="{{ sector.name_en }}" 
        data-name-mr="{{ sector.name_mr }}"
        {% if sector.id|stringformat:"s" == selected_sector %}selected{% endif %}>
        {% if is_english %}{{ sector.name_en }}{% else %}{{ sector.name_mr }}{% endif %}
      </option>
    {% endfor %}
  </select>
  <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 pt-6">
    <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
      <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>
    </svg>
  </div>
</div>
        <!-- Reset Button -->
        <!-- Button row with improved layout -->
        <div class="col-span-1 md:col-span-2 flex justify-between items-center">
          <!-- Reset Button - Changed to button type for proper form reset -->
          <button type="reset" class="py-2.5 px-8 rounded-lg text-sm font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300 hover:shadow-md transition-all duration-300 transform hover:-translate-y-0.5 flex items-center">
            <span class="english-text flex items-center">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
              Reset Form
            </span>
            <span class="marathi-text hidden flex items-center">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
              फॉर्म रीसेट करा
            </span>
          </button>

          <!-- Submit Button -->
          <button type="submit" id="submitBtn" class="py-2.5 px-8 rounded-lg text-sm font-semibold bg-gradient-to-r from-saffron to-yellow-500 text-white hover:shadow-md transition-all duration-300 transform hover:-translate-y-0.5">
            <span class="english-text flex items-center">
              Get Work Suggestions
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </span>
            <span class="marathi-text hidden flex items-center">
              कामाच्या सूचना मिळवा
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </span>
          </button>
        </div>
      </form>
    </div>
</div>

<!-- Enhanced Suggestions Section with modern UI -->
<div id="suggestions-container" class="space-y-8">
    <div class="p-5 bg-gradient-to-r from-navyBlue via-blue-600 to-blue-700 text-white rounded-xl shadow-lg flex justify-between items-center">
        <div>
            <h4 class="text-2xl font-bold english-text flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                </svg>
                Work Suggestions
            </h4>
            <h4 class="text-2xl font-bold marathi-text hidden flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                </svg>
                कामाच्या सूचना
            </h4>
            <div class="w-20 h-1 bg-saffron mt-2"></div>
        </div>
        <div class="hidden md:block">
            <div class="animate-pulse flex space-x-1">
                <div class="h-2 w-2 bg-white rounded-full"></div>
                <div class="h-2 w-2 bg-white rounded-full"></div>
                <div class="h-2 w-2 bg-white rounded-full"></div>
            </div>
        </div>
    </div>

    {% if suggestions %}
        {% regroup suggestions by work_type.sector as sector_list %}
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for sector in sector_list %}
                <div class="rounded-xl shadow-lg overflow-hidden border border-gray-200 transition-all duration-300 hover:shadow-xl transform hover:-translate-y-1 hover:border-blue-300">
                    <div class="p-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 bg-blue-400 bg-opacity-30 rounded-full w-16 h-16"></div>
                        <div class="absolute -right-2 -bottom-2 bg-blue-400 bg-opacity-20 rounded-full w-12 h-12"></div>
                        <h4 class="text-xl font-bold relative z-10 flex items-center">
                            {% if sector.grouper == "Water" %}
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                                </svg>
                            {% elif sector.grouper == "Agriculture" %}
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            {% elif sector.grouper == "Road" %}
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                                </svg>
                            {% else %}
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"></path>
                                </svg>
                            {% endif %}
                            {{ sector.grouper }}
                        </h4>
                        <span class="text-xs text-blue-100 opacity-75">{{ sector.list|length }} suggestions</span>
                    </div>
                    <div class="p-4 bg-white">
                        <ul class="space-y-2">
                            {% for suggestion in sector.list %}
                                <li class="transition-all duration-300 rounded-lg border border-transparent hover:border-gray-200 hover:bg-blue-50 group">
                                    <div class="p-3">
                                        <div class="flex flex-wrap justify-between items-center">
                                            <div class="flex-grow pr-2">
                                                <p class="font-medium text-gray-800 group-hover:text-blue-700 transition-colors">{{ suggestion.work_type.name_en }}</p>
                                                {% if suggestion.is_specialty %}
                                                    <div class="mt-1.5">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                            <svg class="mr-1 h-3 w-3 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                                                                <path fill-rule="evenodd" d="M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1z" clip-rule="evenodd"></path>
                                                                <path d="M11 5a3 3 0 116 0 3 3 0 01-6 0zm3 9a8 8 0 100-16 8 8 0 000 16z"></path>
                                                            </svg>
                                                            <span class="english-text">Specialty Work</span>
                                                            <span class="marathi-text hidden">विशेष काम</span>
                                                        </span>
                                                    </div>
                                                {% endif %}
                                            </div>
                                            <div class="flex space-x-2">
                                                <!-- Edit Button -->
                                                <button type="button" data-id="{{ suggestion.id }}" class="edit-suggestion px-3 py-1.5 text-xs rounded-md bg-blue-50 text-blue-600 hover:bg-blue-600 hover:text-white transition-colors duration-200 flex items-center border border-blue-200 hover:border-blue-600 hover:shadow-md">
                                                    <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                    </svg>
                                                    <span class="english-text">Edit</span>
                                                    <span class="marathi-text hidden">संपादित करा</span>
                                                </button>
                                                
                                                <!-- Delete Button -->
                                                <button type="button" data-id="{{ suggestion.id }}" class="delete-suggestion px-3 py-1.5 text-xs rounded-md bg-red-50 text-red-600 hover:bg-red-600 hover:text-white transition-colors duration-200 flex items-center border border-red-200 hover:border-red-600 hover:shadow-md">
                                                    <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                    </svg>
                                                    <span class="english-text">Delete</span>
                                                    <span class="marathi-text hidden">हटवा</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                        <div class="mt-4 pt-3 border-t border-dashed border-gray-200 text-center">
                            <a href="#" class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center justify-center">
                                <span class="english-text">View All {{ sector.grouper }} Suggestions</span>
                                <span class="marathi-text hidden">सर्व {{ sector.grouper }} सूचना पहा</span>
                                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        
    {% else %}
        <div class="p-6 bg-white rounded-xl shadow-lg border border-gray-200">
            <div class="p-8 rounded-2xl bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 text-center relative overflow-hidden">
                <!-- Decorative elements -->
                <div class="absolute top-0 right-0 -mt-6 -mr-6 w-24 h-24 rounded-full bg-gray-200 opacity-50"></div>
                <div class="absolute bottom-0 left-0 -mb-6 -ml-6 w-20 h-20 rounded-full bg-gray-200 opacity-30"></div>

                <div class="bg-white p-4 rounded-xl shadow-md inline-block mb-6 relative z-10">
                    <svg class="w-16 h-16 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                </div>
                
                <h5 class="font-bold text-xl text-gray-800 mb-3 english-text">No Work Suggestions Available</h5>
                <h5 class="font-bold text-xl text-gray-800 mb-3 marathi-text hidden">कोणत्याही कामाच्या सूचना उपलब्ध नाहीत</h5>
                
                <p class="text-gray-600 mb-6 max-w-md mx-auto english-text">Please select different location details to find available work suggestions for your area.</p>
                <p class="text-gray-600 mb-6 max-w-md mx-auto marathi-text hidden">कृपया आपल्या क्षेत्रासाठी उपलब्ध कामाच्या सूचना शोधण्यासाठी वेगळे स्थान तपशील निवडा.</p>
                
                <button type="button" onclick="document.getElementById('submitBtn').scrollIntoView({behavior: 'smooth'})" class="bg-gradient-to-r from-saffron to-yellow-500 text-white rounded-lg px-6 py-3 font-medium hover:shadow-lg transition-all duration-300 flex items-center mx-auto">
                    <span class="english-text flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Try Different Selection
                    </span>
                    <span class="marathi-text hidden flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        वेगळी निवड प्रयत्न करा
                    </span>
                </button>
            </div>
        </div>
    {% endif %}
</div>
</div>

<!-- Create Suggestion Modal -->
<div id="createSuggestionModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <!-- Background overlay -->
        <div class="fixed inset-0 transition-opacity" aria-hidden="true">
            <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
        </div>

        <!-- Modal container -->
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
            <form id="createSuggestionForm" method="post" class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                {% csrf_token %}
                <div class="sm:flex sm:items-start">
                    <div class="mt-3 text-center sm:mt-0 sm:text-left w-full">
                        <!-- Modal header -->
                        <div class="flex justify-between items-center pb-3 border-b">
                            <h3 class="text-xl leading-6 font-medium text-gray-900 english-text">Create New Work Suggestion</h3>
                            <h3 class="text-xl leading-6 font-medium text-gray-900 marathi-text hidden">नवीन कामाची सूचना तयार करा</h3>
                            <button type="button" id="closeCreateModal" class="text-gray-400 hover:text-gray-500 focus:outline-none">
                                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>

                        <!-- Modal body -->
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- District -->
                            <div class="col-span-1">
                                <label for="modal-district" class="block text-sm font-medium text-gray-700 english-text">District</label>
                                <label for="modal-district" class="block text-sm font-medium text-gray-700 marathi-text hidden">जिल्हा</label>
                                <select id="modal-district" name="district" required class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-saffron focus:border-saffron sm:text-sm rounded-md">
                                    <option value="">
                                        <span class="english-text">Select District</span>
                                        <span class="marathi-text hidden">जिल्हा निवडा</span>
                                    </option>
                                    {% for district in districts %}
                                        <option value="{{ district.id }}" data-name-en="{{ district.name_en }}" data-name-mr="{{ district.name_mr }}">
                                            {% if is_english %}{{ district.name_en }}{% else %}{{ district.name_mr }}{% endif %}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Taluka -->
                            <div class="col-span-1">
                                <label for="modal-taluka" class="block text-sm font-medium text-gray-700 english-text">Taluka</label>
                                <label for="modal-taluka" class="block text-sm font-medium text-gray-700 marathi-text hidden">तालुका</label>
                                <select id="modal-taluka" name="taluka" required class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-saffron focus:border-saffron sm:text-sm rounded-md">
                                    <option value="">
                                        <span class="english-text">Select Taluka</span>
                                        <span class="marathi-text hidden">तालुका निवडा</span>
                                    </option>
                                </select>
                                <!-- Loading indicator for taluka -->
                                <div id="modal-taluka-loading" class="hidden mt-1">
                                    <div class="animate-spin h-4 w-4 border-2 border-saffron rounded-full border-t-transparent"></div>
                                </div>
                            </div>

                            <!-- Gram Panchayat -->
                            <div class="col-span-1">
                                <label for="modal-gram-panchayat" class="block text-sm font-medium text-gray-700 english-text">Gram Panchayat</label>
                                <label for="modal-gram-panchayat" class="block text-sm font-medium text-gray-700 marathi-text hidden">ग्रामपंचायत</label>
                                <select id="modal-gram-panchayat" name="gram_panchayat" required class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-saffron focus:border-saffron sm:text-sm rounded-md">
                                    <option value="">
                                        <span class="english-text">Select Gram Panchayat</span>
                                        <span class="marathi-text hidden">ग्रामपंचायत निवडा</span>
                                    </option>
                                </select>
                                <!-- Loading indicator for gram panchayat -->
                                <div id="modal-gp-loading" class="hidden mt-1">
                                    <div class="animate-spin h-4 w-4 border-2 border-saffron rounded-full border-t-transparent"></div>
                                </div>
                            </div>

                            <!-- Sector -->
                            <div class="col-span-1">
                                <label for="modal-sector" class="block text-sm font-medium text-gray-700 english-text">Sector</label>
                                <label for="modal-sector" class="block text-sm font-medium text-gray-700 marathi-text hidden">क्षेत्र</label>
                                <select id="modal-sector" name="sector" required class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-saffron focus:border-saffron sm:text-sm rounded-md">
                                    <option value="">
                                        <span class="english-text">Select Sector</span>
                                        <span class="marathi-text hidden">क्षेत्र निवडा</span>
                                    </option>
                                    {% for sector in sectors %}
                                        <option value="{{ sector.id }}" data-name-en="{{ sector.name_en }}" data-name-mr="{{ sector.name_mr }}">
                                            {% if is_english %}{{ sector.name_en }}{% else %}{{ sector.name_mr }}{% endif %}
                                        </option>
                                    {% endfor %}
                                </select>
                                <!-- Loading indicator for sector -->
                                <div id="modal-wt-loading" class="hidden mt-1">
                                    <div class="animate-spin h-4 w-4 border-2 border-saffron rounded-full border-t-transparent"></div>
                                </div>
                            </div>

                            <!-- Work Type -->
                            <div class="col-span-2">
                                <label for="modal-work-type" class="block text-sm font-medium text-gray-700 english-text">Work Type</label>
                                <label for="modal-work-type" class="block text-sm font-medium text-gray-700 marathi-text hidden">कामाचा प्रकार</label>
                                <select id="modal-work-type" name="work_type" required class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-saffron focus:border-saffron sm:text-sm rounded-md">
                                    <option value="">
                                        <span class="english-text">Select Work Type</span>
                                        <span class="marathi-text hidden">कामाचा प्रकार निवडा</span>
                                    </option>
                                </select>
                                <!-- Loading indicator for work types -->
                                <div id="modal-worktype-loading" class="hidden mt-1">
                                    <div class="animate-spin h-4 w-4 border-2 border-saffron rounded-full border-t-transparent"></div>
                                </div>
                            </div>

                            <!-- Is Specialty Checkbox -->
                            <div class="col-span-2 mt-2">
                                <div class="flex items-center">
                                    <input id="modal-is-specialty" name="is_specialty" type="checkbox" class="h-4 w-4 text-saffron focus:ring-saffron border-gray-300 rounded">
                                    <label for="modal-is-specialty" class="ml-2 block text-sm text-gray-700 english-text">Mark as specialty work for this Gram Panchayat</label>
                                    <label for="modal-is-specialty" class="ml-2 block text-sm text-gray-700 marathi-text hidden">या ग्रामपंचायतीसाठी विशेष काम म्हणून चिन्हांकित करा</label>
                                </div>
                                <p class="mt-1 text-xs text-gray-500 english-text">Specialty works are prioritized for the gram panchayat</p>
                                <p class="mt-1 text-xs text-gray-500 marathi-text hidden">विशेष कामांना ग्रामपंचायतीसाठी प्राधान्य दिले जाते</p>
                            </div>

                            <!-- Validation Error Display -->
                            <div id="modal-error" class="hidden col-span-2 mt-2 p-2 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm"></div>
                        </div>
                    </div>
                </div>

                <!-- Modal footer -->
                <div class="mt-5 sm:mt-4 sm:flex sm:flex-row-reverse border-t pt-4">
                    <button type="submit" id="submitCreateForm" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm">
                        <span class="english-text">Create Suggestion</span>
                        <span class="marathi-text hidden">सूचना तयार करा</span>
                    </button>
                    <button type="button" id="cancelCreateModal" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-saffron sm:mt-0 sm:w-auto sm:text-sm">
                        <span class="english-text">Cancel</span>
                        <span class="marathi-text hidden">रद्द करा</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    // Track language state
    let isEnglish = false;
    
    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Set Marathi as active by default
        document.getElementById('marathiBtn').classList.add('bg-saffron', 'text-white');
        document.getElementById('englishBtn').classList.remove('bg-saffron', 'text-white');
        
        // Hide English, show Marathi by default
        document.querySelectorAll('.english-text').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('.marathi-text').forEach(el => el.classList.remove('hidden'));
        
        // Initialize district dropdown with proper data attributes
        initializeDistrictDropdown();
        
        // Update language for all dropdowns after initialization
        updateDropdownsLanguage();
        
        // Set default dropdown placeholders in Marathi
        document.getElementById('taluka').innerHTML = '<option value="">तालुका निवडा</option>';
        document.getElementById('gram_panchayat').innerHTML = '<option value="">ग्रामपंचायत निवडा</option>';
        
        // Initialize event listeners
        setupEventListeners();
        
        // Add ripple effect to buttons
        addRippleEffect();
        
        // Update modal language to Marathi by default
        document.querySelectorAll('#createSuggestionModal .english-text').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('#createSuggestionModal .marathi-text').forEach(el => el.classList.remove('hidden'));
        
        // Initialize modal dropdowns
        initializeModalDropdowns();
    });
    
    function initializeDistrictDropdown() {
        const districtSelect = document.getElementById('district');
        if (!districtSelect) return;
        
        // Set all options with proper data attributes
        Array.from(districtSelect.options).forEach(option => {
            if (option.value) {
                // Store both English and Marathi names in data attributes
                if (!option.dataset.nameEn) option.dataset.nameEn = option.textContent;
                if (!option.dataset.nameMr) option.dataset.nameMr = option.textContent;
                
                // Set initial display based on current language
                option.textContent = isEnglish ? option.dataset.nameEn : option.dataset.nameMr;
            }
        });
        
        // If district is already selected (from page reload), ensure it's displayed properly
        if (districtSelect.value) {
            const selectedOption = districtSelect.options[districtSelect.selectedIndex];
            if (selectedOption) {
                selectedOption.textContent = isEnglish ? selectedOption.dataset.nameEn : selectedOption.dataset.nameMr;
            }
        }
    }
    
    function initializeModalDropdowns() {
        // Initialize district dropdown in modal
        const modalDistrictSelect = document.getElementById('modal-district');
        if (modalDistrictSelect) {
            Array.from(modalDistrictSelect.options).forEach(option => {
                if (option.value) {
                    option.textContent = isEnglish ? option.dataset.nameEn : option.dataset.nameMr;
                }
            });
            
            // Set placeholder text based on language
            if (modalDistrictSelect.options.length > 0 && modalDistrictSelect.options[0].value === "") {
                modalDistrictSelect.options[0].text = isEnglish ? 'Select District' : 'जिल्हा निवडा';
            }
        }
        
        // Set initial texts for other modal dropdowns
        document.getElementById('modal-taluka').innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
        document.getElementById('modal-gram-panchayat').innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
        document.getElementById('modal-work-type').innerHTML = '<option value="">' + (isEnglish ? 'Select Work Type' : 'कामाचा प्रकार निवडा') + '</option>';
        
        // Initialize sector dropdown in modal
        const modalSectorSelect = document.getElementById('modal-sector');
        if (modalSectorSelect) {
            Array.from(modalSectorSelect.options).forEach(option => {
                if (option.value) {
                    option.textContent = isEnglish ? option.dataset.nameEn : option.dataset.nameMr;
                }
            });
            
            // Set placeholder text based on language
            if (modalSectorSelect.options.length > 0 && modalSectorSelect.options[0].value === "") {
                modalSectorSelect.options[0].text = isEnglish ? 'Select Sector' : 'क्षेत्र निवडा';
            }
        }
    }
    
    function updateDropdownsLanguage() {
        ['district', 'taluka', 'gram_panchayat', 'sector'].forEach(id => {
            const dropdown = document.getElementById(id);
            if (!dropdown) return;
            
            Array.from(dropdown.options).forEach(option => {
                if (option.value && option.dataset.nameEn && option.dataset.nameMr) {
                    option.text = isEnglish ? option.dataset.nameEn : option.dataset.nameMr;
                }
            });
            
            if (dropdown.options.length > 0 && dropdown.options[0].value === "") {
                dropdown.options[0].text = isEnglish ? 
                    (id === 'district' ? 'Select District' : 
                    id === 'taluka' ? 'Select Taluka' : 
                    id === 'gram_panchayat' ? 'Select Gram Panchayat' : 'Select Sector') :
                    (id === 'district' ? 'जिल्हा निवडा' : 
                    id === 'taluka' ? 'तालुका निवडा' : 
                    id === 'gram_panchayat' ? 'ग्रामपंचायत निवडा' : 'क्षेत्र निवडा');
            }
        });
        
        // Also update modal dropdowns
        ['modal-district', 'modal-taluka', 'modal-gram-panchayat', 'modal-sector', 'modal-work-type'].forEach(id => {
            const dropdown = document.getElementById(id);
            if (!dropdown) return;
            
            Array.from(dropdown.options).forEach(option => {
                if (option.value && option.dataset.nameEn && option.dataset.nameMr) {
                    option.text = isEnglish ? option.dataset.nameEn : option.dataset.nameMr;
                }
            });
            
            if (dropdown.options.length > 0 && dropdown.options[0].value === "") {
                dropdown.options[0].text = isEnglish ? 
                    (id === 'modal-district' ? 'Select District' : 
                    id === 'modal-taluka' ? 'Select Taluka' : 
                    id === 'modal-gram-panchayat' ? 'Select Gram Panchayat' : 
                    id === 'modal-sector' ? 'Select Sector' : 'Select Work Type') :
                    (id === 'modal-district' ? 'जिल्हा निवडा' : 
                    id === 'modal-taluka' ? 'तालुका निवडा' : 
                    id === 'modal-gram-panchayat' ? 'ग्रामपंचायत निवडा' : 
                    id === 'modal-sector' ? 'क्षेत्र निवडा' : 'कामाचा प्रकार निवडा');
            }
        });
    }
    
    function setupEventListeners() {
        // Language toggle buttons
        document.getElementById('englishBtn').addEventListener('click', function() {
            isEnglish = true;
            updateLanguageUI();
            updateDropdownsLanguage();
        });
        
        document.getElementById('marathiBtn').addEventListener('click', function() {
            isEnglish = false;
            updateLanguageUI();
            updateDropdownsLanguage();
        });

        // District dropdown
        document.getElementById('district').addEventListener('change', handleDistrictChange);
        
        // Taluka dropdown
        document.getElementById('taluka').addEventListener('change', handleTalukaChange);
        
        // Form submission
        document.getElementById('suggestionForm').addEventListener('submit', handleFormSubmit);
        
        // Form reset - Add animation
        document.querySelector('button[type="reset"]').addEventListener('click', function() {
            // Add a subtle shake animation to the form
            const form = document.getElementById('suggestionForm');
            form.classList.add('animate-shake');
            setTimeout(() => form.classList.remove('animate-shake'), 500);
            
            // Reset dropdowns with proper language
            setTimeout(() => {
                document.getElementById('taluka').innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
                document.getElementById('gram_panchayat').innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
                
                // Clear any suggestions
                document.getElementById('suggestions-container').innerHTML = '';
            }, 100);
        });
        
        // Add the shake animation CSS
        const shakeStyle = document.createElement('style');
        shakeStyle.innerHTML = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(5px); }
                75% { transform: translateX(-5px); }
            }
            .animate-shake {
                animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            }
        `;
        document.head.appendChild(shakeStyle);
        
        // Modal event listeners
        const createModal = document.getElementById('createSuggestionModal');
        const openCreateModalBtn = document.getElementById('openCreateModal');
        const closeCreateModalBtn = document.getElementById('closeCreateModal');
        const cancelCreateModalBtn = document.getElementById('cancelCreateModal');

        // Open modal
        openCreateModalBtn.addEventListener('click', () => {
            createModal.classList.remove('hidden');
            document.body.classList.add('overflow-hidden');
            
            // Reset form when opening modal
            document.getElementById('createSuggestionForm').reset();
            resetModalSelects();
        });

        // Close modal
        function closeCreateModal() {
            createModal.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
            // Clear any error messages
            document.getElementById('modal-error').classList.add('hidden');
        }

        closeCreateModalBtn.addEventListener('click', closeCreateModal);
        cancelCreateModalBtn.addEventListener('click', closeCreateModal);

        // Close modal when clicking outside
        createModal.addEventListener('click', (e) => {
            if (e.target === createModal) {
                closeCreateModal();
            }
        });
        
        // Modal district change handler
        document.getElementById('modal-district').addEventListener('change', function() {
            const talukaSelect = document.getElementById('modal-taluka');
            const loadingIndicator = document.getElementById('modal-taluka-loading');
            
            if (!this.value) {
                talukaSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
                document.getElementById('modal-gram-panchayat').innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
                return;
            }
            
            talukaSelect.disabled = true;
            loadingIndicator.classList.remove('hidden');
            
            fetch(`/get-talukas/?district_id=${this.value}`)
                .then(res => res.json())
                .then(data => {
                    talukaSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
                    data.forEach(t => {
                        const option = new Option();
                        option.value = t.id;
                        option.dataset.nameEn = t.name_en;
                        option.dataset.nameMr = t.name_mr;
                        option.text = isEnglish ? t.name_en : t.name_mr;
                        talukaSelect.add(option);
                    });
                })
                .catch(err => {
                    console.error('Error loading talukas:', err);
                    showModalError(isEnglish ? 'Failed to load talukas' : 'तालुका लोड करण्यात अयशस्वी');
                })
                .finally(() => {
                    talukaSelect.disabled = false;
                    loadingIndicator.classList.add('hidden');
                });
        });

        // Modal taluka change handler
        document.getElementById('modal-taluka').addEventListener('change', function() {
            const gpSelect = document.getElementById('modal-gram-panchayat');
            const loadingIndicator = document.getElementById('modal-gp-loading');
            
            if (!this.value) {
                gpSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
                return;
            }
            
            gpSelect.disabled = true;
            loadingIndicator.classList.remove('hidden');
            
            fetch(`/get-gram-panchayats/?taluka_id=${this.value}`)
                .then(res => res.json())
                .then(data => {
                    gpSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
                    data.forEach(gp => {
                        const option = new Option();
                        option.value = gp.id;
                        option.dataset.nameEn = gp.name_en;
                        option.dataset.nameMr = gp.name_mr;
                        option.text = isEnglish ? gp.name_en : gp.name_mr;
                        gpSelect.add(option);
                    });
                })
                .catch(err => {
                    console.error('Error loading gram panchayats:', err);
                    showModalError(isEnglish ? 'Failed to load gram panchayats' : 'ग्रामपंचायती लोड करण्यात अयशस्वी');
                })
                .finally(() => {
                    gpSelect.disabled = false;
                    loadingIndicator.classList.add('hidden');
                });
        });

            // Modal sector change handler - load work types
            document.getElementById('modal-sector').addEventListener('change', function() {
                const workTypeSelect = document.getElementById('modal-work-type');
                const loadingIndicator = document.getElementById('modal-worktype-loading');
                
                if (!this.value) {
                    workTypeSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Work Type' : 'कामाचा प्रकार निवडा') + '</option>';
                    return;
                }
                
                workTypeSelect.disabled = true;
                loadingIndicator.classList.remove('hidden');
                
                // This matches the Django view expecting 'sector' as the parameter name
                fetch(`/get-work-types/?sector=${this.value}`)
                    .then(res => res.json())
                    .then(data => {
                        workTypeSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Work Type' : 'कामाचा प्रकार निवडा') + '</option>';
                        // Process the work types returned from the Django view
                        data.forEach(wt => {
                            const option = new Option();
                            option.value = wt.id;
                            option.dataset.nameEn = wt.name_en;
                            option.dataset.nameMr = wt.name_mr;
                            option.text = isEnglish ? wt.name_en : wt.name_mr;
                            workTypeSelect.add(option);
                        });
                    })
                    .catch(err => {
                        console.error('Error loading work types:', err);
                        showModalError(isEnglish ? 'Failed to load work types' : 'कामाचे प्रकार लोड करण्यात अयशस्वी');
                    })
                    .finally(() => {
                        workTypeSelect.disabled = false;
                        loadingIndicator.classList.add('hidden');
                    });
            });

            // Form submission for creating new suggestion
            document.getElementById('createSuggestionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Clear previous errors
                document.getElementById('modal-error').classList.add('hidden');
                
                // Validate form
                const district = document.getElementById('modal-district').value;
                const taluka = document.getElementById('modal-taluka').value;
                const gramPanchayat = document.getElementById('modal-gram-panchayat').value;
                const sector = document.getElementById('modal-sector').value;
                const workType = document.getElementById('modal-work-type').value;
                
                if (!district || !taluka || !gramPanchayat || !sector || !workType) {
                    showModalError(isEnglish ? 'Please fill all required fields' : 'कृपया सर्व आवश्यक फील्ड भरा');
                    return;
                }
                
                const submitBtn = document.getElementById('submitCreateForm');
                const originalBtnText = submitBtn.innerHTML;
                
                // Show loading state
                submitBtn.disabled = true;
                submitBtn.innerHTML = isEnglish ? 
                    '<div class="animate-spin h-4 w-4 border-2 border-white rounded-full border-t-transparent mr-2"></div> Creating...' : 
                    '<div class="animate-spin h-4 w-4 border-2 border-white rounded-full border-t-transparent mr-2"></div> तयार करत आहे...';
                
                // Get form data
                const formData = new FormData(this);
                
                // Send data to server
                fetch('/create-suggestion/', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': getCsrfToken(),
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Creation failed');
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    // Close modal
                    document.getElementById('createSuggestionModal').classList.add('hidden');
                    document.body.classList.remove('overflow-hidden');
                    
                    // Show success notification
                    showNotification(
                        isEnglish ? 'Suggestion created successfully' : 'सूचना यशस्वीरित्या तयार केली',
                        'success'
                    );
                    
                    // Reset form
                    this.reset();
                    resetModalSelects();
                    
                    // Refresh suggestions list
                    document.getElementById('suggestionForm').dispatchEvent(new Event('submit'));
                })
                .catch(error => {
                    console.error('Error:', error);
                    showModalError(error.message || (isEnglish ? 
                        'Failed to create suggestion' : 'सूचना तयार करण्यात अयशस्वी'));
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                });
            });
            }

            function resetModalSelects() {
            // Reset all modal dropdowns to their default state
            document.getElementById('modal-taluka').innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
            document.getElementById('modal-gram-panchayat').innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
            document.getElementById('modal-work-type').innerHTML = '<option value="">' + (isEnglish ? 'Select Work Type' : 'कामाचा प्रकार निवडा') + '</option>';
            }

            function showModalError(message) {
            const errorDiv = document.getElementById('modal-error');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');

            // Scroll to error message
            errorDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
    function updateLanguageUI() {
        const englishBtn = document.getElementById('englishBtn');
        const marathiBtn = document.getElementById('marathiBtn');
        
        if (isEnglish) {
            document.querySelectorAll('.english-text').forEach(el => el.classList.remove('hidden'));
            document.querySelectorAll('.marathi-text').forEach(el => el.classList.add('hidden'));
            englishBtn.classList.add('bg-saffron', 'text-white');
            marathiBtn.classList.remove('bg-saffron', 'text-white');
        } else {
            document.querySelectorAll('.english-text').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.marathi-text').forEach(el => el.classList.remove('hidden'));
            englishBtn.classList.remove('bg-saffron', 'text-white');
            marathiBtn.classList.add('bg-saffron', 'text-white');
        }
        
        // Update modal language
        document.querySelectorAll('#createSuggestionModal .english-text').forEach(el => 
            isEnglish ? el.classList.remove('hidden') : el.classList.add('hidden')
        );
        document.querySelectorAll('#createSuggestionModal .marathi-text').forEach(el => 
            isEnglish ? el.classList.add('hidden') : el.classList.remove('hidden')
        );
    }

    function handleDistrictChange() {
        const districtId = this.value;
        const talukaSelect = document.getElementById('taluka');
        const loading = document.getElementById('taluka-loading');
        
        if (!districtId) {
            talukaSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
            document.getElementById('gram_panchayat').innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
            return;
        }
        
        talukaSelect.disabled = true;
        loading.classList.remove('hidden');
        
        fetch(`/get-talukas/?district_id=${districtId}`)
            .then(response => response.json())
            .then(data => {
                talukaSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Taluka' : 'तालुका निवडा') + '</option>';
                data.forEach(taluka => {
                    const option = new Option();
                    option.value = taluka.id;
                    option.dataset.nameEn = taluka.name_en;
                    option.dataset.nameMr = taluka.name_mr;
                    option.text = isEnglish ? taluka.name_en : taluka.name_mr;
                    talukaSelect.add(option);
                });
            })
            .catch(err => {
                console.error('Error loading talukas:', err);
            })
            .finally(() => {
                talukaSelect.disabled = false;
                loading.classList.add('hidden');
            });
    }

    function handleTalukaChange() {
        const talukaId = this.value;
        const gpSelect = document.getElementById('gram_panchayat');
        const loading = document.getElementById('gp-loading');
        
        if (!talukaId) {
            gpSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
            return;
        }
        
        gpSelect.disabled = true;
        loading.classList.remove('hidden');
        
        fetch(`/get-gram-panchayats/?taluka_id=${talukaId}`)
            .then(response => response.json())
            .then(data => {
                gpSelect.innerHTML = '<option value="">' + (isEnglish ? 'Select Gram Panchayat' : 'ग्रामपंचायत निवडा') + '</option>';
                data.forEach(gp => {
                    const option = new Option();
                    option.value = gp.id;
                    option.dataset.nameEn = gp.name_en;
                    option.dataset.nameMr = gp.name_mr;
                    option.text = isEnglish ? gp.name_en : gp.name_mr;
                    gpSelect.add(option);
                });
            })
            .catch(err => {
                console.error('Error loading gram panchayats:', err);
            })
            .finally(() => {
                gpSelect.disabled = false;
                loading.classList.add('hidden');
            });
    }
    
    function handleFormSubmit(e) {
        e.preventDefault();
        
        const submitBtn = document.getElementById('submitBtn');
        const suggestionsContainer = document.getElementById('suggestions-container');
        
        // Clear previous results with fade-out effect
        suggestionsContainer.classList.add('opacity-0');
        setTimeout(() => {
            suggestionsContainer.innerHTML = '';
            suggestionsContainer.classList.remove('opacity-0');
        }, 300);
        
        // Show loading state
        submitBtn.disabled = true;
        submitBtn.innerHTML = isEnglish ? 
            '<span class="flex items-center"><div class="animate-spin mr-2 h-4 w-4 border-2 border-white rounded-full border-t-transparent"></div>Loading...</span>' :
            '<span class="flex items-center"><div class="animate-spin mr-2 h-4 w-4 border-2 border-white rounded-full border-t-transparent"></div>लोड होत आहे...</span>';

        const formData = {
            district: document.getElementById('district').value,
            taluka: document.getElementById('taluka').value,
            gram_panchayat: document.getElementById('gram_panchayat').value,
            sector: document.getElementById('sector').value
        };

        // Validation
        if (!formData.gram_panchayat) {
            showError(isEnglish ? 'Please select a Gram Panchayat' : 'कृपया ग्रामपंचायत निवडा');
            submitBtn.disabled = false;
            resetSubmitButton();
            return;
        }

        // Request with simulated delay for smooth transitions
        setTimeout(() => {
            fetch(`/get-suggestions/?${new URLSearchParams(formData)}`)
                .then(response => {
                    if (!response.ok) {
                        // Get the error message from response if available
                        return response.json().then(err => {
                            throw new Error(err.message || 'Request failed');
                        }).catch(() => {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    if (!data.suggestions) {
                        throw new Error('Invalid response format - missing suggestions');
                    }
                    updateSuggestionsUI(data.suggestions);
                })
                .catch(error => {
                    console.error('Fetch error:', error);
                    showError(isEnglish ? 
                        `Error: ${error.message}` : 
                        `त्रुटी: ${error.message}`);
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    resetSubmitButton();
                });
        }, 1000); // Simulated delay for better UX
    }
    
    function resetSubmitButton() {
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.innerHTML = isEnglish ? 
            '<span class="english-text flex items-center">Get Work Suggestions<svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></span>' : 
            '<span class="marathi-text flex items-center">कामाच्या सूचना मिळवा<svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></span>';
    }
    
    function showError(message) {
        const suggestionsContainer = document.getElementById('suggestions-container');
        suggestionsContainer.innerHTML = `
            <div class="p-4 mb-4 bg-gradient-to-r from-red-50 to-red-100 text-red-800 rounded-xl border-l-4 border-red-500 animate-fadeIn">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <svg class="w-5 h-5 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <p class="font-medium">${message}</p>
                    </div>
                </div>
            </div>
        `;
        
        // Add fadeIn animation
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes fadeIn {
                0% { opacity: 0; transform: translateY(-10px); }
                100% { opacity: 1; transform: translateY(0); }
            }
            .animate-fadeIn {
                animation: fadeIn 0.5s ease-out forwards;
            }
        `;
        document.head.appendChild(style);
    }
    
    function addRippleEffect() {
        const buttons = document.querySelectorAll('button:not([type="reset"])');
        buttons.forEach(button => {
            button.addEventListener('click', function(e) {
                const x = e.clientX - e.target.getBoundingClientRect().left;
                const y = e.clientY - e.target.getBoundingClientRect().top;
                
                const ripple = document.createElement('span');
                ripple.classList.add('ripple-effect');
                ripple.style.top = `${y}px`;
                ripple.style.left = `${x}px`;
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        });
        
        // Add the necessary CSS
        const style = document.createElement('style');
        style.innerHTML = `
            .ripple-effect {
                position: absolute;
                background: rgba(255, 255, 255, 0.4);
                border-radius: 50%;
                pointer-events: none;
                width: 100px;
                height: 100px;
                transform: scale(0);
                animation: ripple 0.6s linear;
            }
            
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            
            button {
                overflow: hidden;
                position: relative;
            }
        `;
        document.head.appendChild(style);
    }
    
    function updateSuggestionsUI(suggestions) {
        const container = document.getElementById('suggestions-container');
        
        if (!suggestions || suggestions.length === 0) {
            container.innerHTML = buildNoSuggestionsHTML();
            return;
        }
        
        // Group by sector for display
        const sectors = {};
        suggestions.forEach(suggestion => {
            const sectorId = suggestion.work_type.sector.id;
            if (!sectors[sectorId]) {
                sectors[sectorId] = {
                    name_en: suggestion.work_type.sector.name_en,
                    name_mr: suggestion.work_type.sector.name_mr,
                    suggestions: []
                };
            }
            sectors[sectorId].suggestions.push(suggestion);
        });
        
        // Add appropriate header
        let html = `
            <div class="p-5 bg-gradient-to-r from-navyBlue via-blue-600 to-blue-700 text-white rounded-xl shadow-lg flex justify-between items-center">
                <div>
                    <h4 class="text-2xl font-bold english-text flex items-center ${isEnglish ? '' : 'hidden'}">
                        <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        Work Suggestions (${suggestions.length})
                    </h4>
                    <h4 class="text-2xl font-bold marathi-text flex items-center ${!isEnglish ? '' : 'hidden'}">
                        <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        कामाच्या सूचना (${suggestions.length})
                    </h4>
                    <div class="w-20 h-1 bg-saffron mt-2"></div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6">
        `;
        
        // Add each sector card
        Object.entries(sectors).forEach(([sectorId, sectorData], index) => {
            const sectorName = isEnglish ? sectorData.name_en : sectorData.name_mr;
            html += `
                <div class="rounded-xl shadow-lg overflow-hidden border border-gray-200 transition-all duration-300 hover:shadow-xl transform hover:-translate-y-1 hover:border-blue-300 opacity-0 animate-fadeIn" style="animation-delay: ${index * 150}ms">
                    <div class="p-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 bg-blue-400 bg-opacity-30 rounded-full w-16 h-16"></div>
                        <div class="absolute -right-2 -bottom-2 bg-blue-400 bg-opacity-20 rounded-full w-12 h-12"></div>
                        <h4 class="text-xl font-bold relative z-10 flex items-center">
                            ${getSectorIcon(sectorData.name_en)}
                            ${sectorName}
                        </h4>
                        <span class="text-xs text-blue-100 opacity-75">${sectorData.suggestions.length} suggestions</span>
                    </div>
                    <div class="p-4 bg-white">
                        <ul class="space-y-2">
            `;
            
            // Add work items
            sectorData.suggestions.forEach(suggestion => {
                html += `
                    <li class="transition-all duration-300 rounded-lg border border-transparent hover:border-gray-200 hover:bg-blue-50 group">
                        <div class="p-3">
                            <div class="flex flex-wrap justify-between items-center">
                                <div class="flex-grow pr-2">
                                    <p class="font-medium text-gray-800 group-hover:text-blue-700 transition-colors">
                                        ${isEnglish ? suggestion.work_type.name_en : suggestion.work_type.name_mr}
                                    </p>
                                    ${suggestion.is_specialty ? `
                                        <div class="mt-1.5">
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                <svg class="mr-1 h-3 w-3 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1z" clip-rule="evenodd"></path>
                                                    <path d="M11 5a3 3 0 116 0 3 3 0 01-6 0zm3 9a8 8 0 100-16 8 8 0 000 16z"></path>
                                                </svg>
                                                <span class="english-text ${isEnglish ? '' : 'hidden'}">Specialty Work</span>
                                                <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">विशेष काम</span>
                                            </span>
                                        </div>
                                    ` : ''}
                                </div>
                                <div class="flex space-x-2">
                                    <!-- Edit Button -->
                                    <button type="button" data-id="${suggestion.id}" class="edit-suggestion px-3 py-1.5 text-xs rounded-md bg-blue-50 text-blue-600 hover:bg-blue-600 hover:text-white transition-colors duration-200 flex items-center border border-blue-200 hover:border-blue-600 hover:shadow-md">
                                        <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                        </svg>
                                        <span class="english-text ${isEnglish ? '' : 'hidden'}">Edit</span>
                                        <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">संपादित करा</span>
                                    </button>
                                    
                                    <!-- Delete Button -->
                                    <button type="button" data-id="${suggestion.id}" class="delete-suggestion px-3 py-1.5 text-xs rounded-md bg-red-50 text-red-600 hover:bg-red-600 hover:text-white transition-colors duration-200 flex items-center border border-red-200 hover:border-red-600 hover:shadow-md">
                                        <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                        </svg>
                                        <span class="english-text ${isEnglish ? '' : 'hidden'}">Delete</span>
                                        <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">हटवा</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </li>
                `;
            });
            
            // Close list and add view all link
            html += `
                        </ul>
                        <div class="mt-4 pt-3 border-t border-dashed border-gray-200 text-center">
                            <a href="#" class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center justify-center">
                                <span class="english-text ${isEnglish ? '' : 'hidden'}">View All ${sectorData.name_en} Suggestions</span>
                                <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">सर्व ${sectorData.name_mr} सूचना पहा</span>
                                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            `;
        });
        
        // Close grid container
        html += `</div>`;
        
        // Set container content
        container.innerHTML = html;
        
        // Add fadeIn animation if not already added
        if (!document.querySelector('style[data-animation="fadeIn"]')) {
            const style = document.createElement('style');
            style.dataset.animation = "fadeIn";
            style.innerHTML = `
                @keyframes fadeIn {
                    0% { opacity: 0; transform: translateY(10px); }
                    100% { opacity: 1; transform: translateY(0); }
                }
                .animate-fadeIn {
                    animation: fadeIn 0.5s ease-out forwards;
                }
            `;
            document.head.appendChild(style);
        }
        
        // Add event listeners to edit and delete buttons
        setTimeout(() => {
            // Edit button event listeners
            document.querySelectorAll('.edit-suggestion').forEach(btn => {
                btn.addEventListener('click', function() {
                    const suggestionId = this.getAttribute('data-id');
                    window.location.href = `/edit-suggestion/${suggestionId}/`;
                });
            });
            
            // Delete button event listeners
            document.querySelectorAll('.delete-suggestion').forEach(btn => {
                btn.addEventListener('click', function() {
                    const suggestionId = this.getAttribute('data-id');
                    confirmDelete(suggestionId);
                });
            });
        }, 500);
    }

    function getSectorIcon(sector) {
        let icon = '';
        
        switch (sector) {
            case 'Water':
                icon = '<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>';
                break;
            case 'Agriculture':
                icon = '<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                break;
            case 'Road':
                icon = '<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg>';
                break;
            case 'Education':
                icon = '<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 14l9-5-9-5-9 5 9 5z"></path><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"></path></svg>';
                break;
            case 'Health':
                icon = '<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>';
                break;
            default:
                icon = '<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"></path></svg>';
        }
        
        return icon;
    }
    
    function buildNoSuggestionsHTML() {
        return `
            <div class="p-6 bg-white rounded-xl shadow-lg border border-gray-200">
                <div class="p-8 rounded-2xl bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 text-center relative overflow-hidden">
                    <!-- Decorative elements -->
                    <div class="absolute top-0 right-0 -mt-6 -mr-6 w-24 h-24 rounded-full bg-gray-200 opacity-50"></div>
                    <div class="absolute bottom-0 left-0 -mb-6 -ml-6 w-20 h-20 rounded-full bg-gray-200 opacity-30"></div>

                    <div class="bg-white p-4 rounded-xl shadow-md inline-block mb-6 relative z-10">
                        <svg class="w-16 h-16 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    
                    <h5 class="font-bold text-xl text-gray-800 mb-3 english-text ${isEnglish ? '' : 'hidden'}">No Work Suggestions Available</h5>
                    <h5 class="font-bold text-xl text-gray-800 mb-3 marathi-text ${!isEnglish ? '' : 'hidden'}">कोणत्याही कामाच्या सूचना उपलब्ध नाहीत</h5>
                    
                    <p class="text-gray-600 mb-6 max-w-md mx-auto english-text ${isEnglish ? '' : 'hidden'}">Please select different location details to find available work suggestions for your area.</p>
                    <p class="text-gray-600 mb-6 max-w-md mx-auto marathi-text ${!isEnglish ? '' : 'hidden'}">कृपया आपल्या क्षेत्रासाठी उपलब्ध कामाच्या सूचना शोधण्यासाठी वेगळे स्थान तपशील निवडा.</p>
                    
                    <button type="button" onclick="document.getElementById('submitBtn').scrollIntoView({behavior: 'smooth'})" class="bg-gradient-to-r from-saffron to-yellow-500 text-white rounded-lg px-6 py-3 font-medium hover:shadow-lg transition-all duration-300 flex items-center mx-auto">
                        <span class="english-text flex items-center ${isEnglish ? '' : 'hidden'}">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                            Try Different Selection
                        </span>
                        <span class="marathi-text flex items-center ${!isEnglish ? '' : 'hidden'}">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                            वेगळी निवड प्रयत्न करा
                        </span>
                    </button>
                </div>
            </div>
        `;
    }
    
    // Function to confirm delete
    function confirmDelete(id) {
        const overlay = document.createElement('div');
        overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
        overlay.id = 'deleteModal';
        
        overlay.innerHTML = `
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all animate-fade-in">
                <div class="p-5 bg-gradient-to-r from-red-600 to-red-500 rounded-t-lg text-white">
                    <h3 class="text-xl font-bold flex items-center">
                        <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                        <span class="english-text ${isEnglish ? '' : 'hidden'}">Confirm Deletion</span>
                        <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">हटविण्याची पुष्टी करा</span>
                    </h3>
                </div>
                <div class="p-6">
                    <p class="text-gray-700 mb-6 english-text ${isEnglish ? '' : 'hidden'}">Are you sure you want to delete this work suggestion? This action cannot be undone.</p>
                    <p class="text-gray-700 mb-6 marathi-text ${!isEnglish ? '' : 'hidden'}">तुम्हाला खात्री आहे की तुम्ही ही कामाची सूचना हटवू इच्छिता? हे कृती पूर्ववत केली जाऊ शकत नाही.</p>
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancelDelete" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg text-gray-800 transition-colors">
                            <span class="english-text ${isEnglish ? '' : 'hidden'}">Cancel</span>
                            <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">रद्द करा</span>
                        </button>
                        <button type="button" id="confirmDelete" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center">
                            <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                            <span class="english-text ${isEnglish ? '' : 'hidden'}">Delete</span>
                            <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">हटवा</span>
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        document.body.appendChild(overlay);
        
        document.getElementById('cancelDelete').addEventListener('click', () => {
            document.getElementById('deleteModal').remove();
        });
        
        document.getElementById('confirmDelete').addEventListener('click', () => {
            document.getElementById('confirmDelete').innerHTML = `
                <div class="animate-spin h-4 w-4 border-2 border-white rounded-full border-t-transparent mr-2"></div>
                <span class="english-text ${isEnglish ? '' : 'hidden'}">Deleting...</span>
                <span class="marathi-text ${!isEnglish ? '' : 'hidden'}">हटवत आहे...</span>
            `;
            document.getElementById('confirmDelete').disabled = true;
            
            fetch(`/delete-suggestion/${id}/`, {
                method: 'DELETE',
                headers: {
                    'X-CSRFToken': getCsrfToken(),
                },
            })
            .then(response => {
                if (!response.ok) throw new Error('Delete failed');
                return response.json();
            })
            .then(() => {
                document.getElementById('deleteModal').remove();
                showNotification(
                    isEnglish ? 'Suggestion deleted successfully' : 'सूचना यशस्वीरित्या हटवली',
                    'success'
                );
                document.getElementById('suggestionForm').dispatchEvent(new Event('submit'));
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('deleteModal').remove();
                showNotification(
                    isEnglish ? 'Failed to delete suggestion' : 'सूचना हटवण्यात अयशस्वी',
                    'error'
                );
            });
        });
    }
    
    // Helper function to get CSRF token
    function getCsrfToken() {
        const name = 'csrftoken';
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    
    // Show notification function
    function showNotification(message, type = 'success') {
        const existingNotification = document.getElementById('notification');
        if (existingNotification) {
            existingNotification.remove();
        }
        
        const notification = document.createElement('div');
        notification.id = 'notification';
        notification.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg flex items-center z-50 ${
            type === 'success' ? 'bg-green-50 text-green-700 border-l-4 border-green-500' : 
            'bg-red-50 text-red-700 border-l-4 border-red-500'
        } transform transition-all duration-500 translate-y-20 opacity-0`;
        
        notification.innerHTML = `
            <div class="mr-3 bg-white bg-opacity-25 rounded-full p-1">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    ${type === 'success' 
                        ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>' 
                        : '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>'
                    }
                </svg>
            </div>
            <p class="font-medium">${message}</p>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.remove('translate-y-20', 'opacity-0');
        }, 10);
        
        setTimeout(() => {
            notification.classList.add('translate-y-20', 'opacity-0');
            setTimeout(() => notification.remove(), 500);
        }, 5000);
    }
</script>
{% endblock %}